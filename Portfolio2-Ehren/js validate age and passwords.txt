/********

I wrote a bunch of javascript to check if the user had selected to be over 18 in the registration forms, which gave the website a bit more of a realistic feel

I also make a kinda fancy colour change system that meant that when the user went to change
their password they had to enter the password twice to confirm it.

******/

/*Check over 18*/
<script>
	function checkDOB(){
		
		var age = 18;
		
		//get fields
		var dateField = document.getElementById('DOB');
		var warningField = document.getElementById('dateWarning');
		
		//get values
		var dateFieldVal = dateField.value;
		console.log('Date is ' + dateFieldVal);
		
		//cast entered date string to workable date object
		var myDate = new Date(dateFieldVal);

		//get the current date to compare to 
		var currdate = new Date();
		
		//calculate the date of the userss 18th birthday
		var setDate = new Date();        
		setDate.setFullYear(myDate.getFullYear() + age,myDate.getMonth()-1, myDate.getDate());

		//if current date is past their 18th birthday
		if ( currdate > setDate){
			//free up form
			warningField.style.visibility = 'hidden';
			btnSubmit.disabled=false;
		}else{
			//warn and restrict
			warningField.style.visibility = 'visible';
			btnSubmit.disabled=true;
		}
	}
	$(document).ready(function(){
		
		//get fields
		var dateField = document.getElementById('DOB');
		var btnSubmit = document.getElementById('btnSubmit');
		var warningField = document.getElementById('dateWarning');
		
		console.log(dateField);
		
		//start with disabled since they haven't selected a date yet
		btnSubmit.disabled=true;
		warningField.style.visibility = "hidden";
		
		//trigger the date checks when the datepicker is changed
		dateField.onpaste = checkDOB;
		dateField.oninput = checkDOB;
	});
</script>


/*check passwords*/
<script>

function checkValid(){
	
	//get fields and controls
	var p1Field = document.getElementById('password');
	var p2Field = document.getElementById('password2');
	var btnSubmit = document.getElementById('btnSubmit');
	
	//get values
	var p1 = p1Field.value;	
	var p2 = p2Field.value;
	var Check = document.getElementById('T&C').checked;
	
	
	//if passwords don't match or are blank show user and disable submit
	if (p1 != p2 || p1==''){
		console.log('setting red');
		p2Field.style.background = 'red';
		btnSubmit.disabled=true;
		return false;
	}else{
		//otherwise green go the form
		console.log('setting green');
		p2Field.style.background = 'green';
		//also check if the terms and conditions are checked
		if (Check == true){
			btnSubmit.disabled=false;
		}
	}
}

$(document).ready(function(){
	
	//get fields and controls
	var p1Field = document.getElementById('password');
	var p2Field = document.getElementById('password2');
	var btnSubmit = document.getElementById('btnSubmit');
	var chk = document.getElementById('T&C');
	
	//start with the form disabled because the password will be blank
	btnSubmit.disabled=true;
	
	//make the validation check happen whenever the form is edited in a way
	//which could change it's validity
	p1Field.onpaste = checkValid;
	p1Field.oninput = checkValid;
	
	p2Field.onpaste = checkValid;
	p2Field.oninput = checkValid;
	
	chk.onchange = checkValid;
});

</script>